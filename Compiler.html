<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Compiler Studio</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        .container {
            display: flex;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        .file-explorer {
            width: 250px;
            background-color: #2C3E50;
            color: white;
            padding: 10px;
            overflow-y: auto;
            height: 100%;
            font-size: 14px;
        }

        .file-explorer h2 {
            font-size: 18px;
            margin-top: 0;
        }

        .file-explorer ul {
            list-style: none;
            padding-left: 0;
        }

        .file-explorer li {
            cursor: pointer;
            padding: 5px;
            margin: 5px 0;
            background-color: #34495E;
            border-radius: 5px;
        }

        .file-explorer li:hover {
            background-color: #1ABC9C;
        }

        .editor {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            height: 100%;
            background-color: #fff;
        }

        .editor h2 {
            font-size: 24px;
        }

        textarea {
            width: 100%;
            height: 200px;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            background-color: #f5f5f5;
            font-family: monospace;
            resize: none;
        }

        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }

        button:hover {
            background-color: #45a049;
        }

        .preview {
            width: 100%;
            height: 500px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <!-- File Explorer -->
    <div class="file-explorer">
        <h2>File Explorer</h2>
        <ul id="file-list">
            <!-- Dynamic File List Will Appear Here -->
        </ul>
    </div>

    <!-- Editor Section -->
    <div class="editor">
        <h2>Edit File</h2>

        <div id="editor-container">
            <!-- Dynamically Injected Editors for HTML, CSS, JS -->
        </div>

        <button id="save-button" onclick="saveFile()">Save</button>

        <div class="preview" id="preview-frame"></div>
    </div>
</div>

<script>
    // In-memory project files structure
    let projectFiles = {
        "index.html": "<!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><title>Sample Project</title></head><body><h1>Welcome to Firebase Studio Clone!</h1><script src='script.js'></script></body></html>",
        "styles.css": "body { font-family: Arial, sans-serif; background-color: #f4f4f4; }",
        "script.js": "console.log('JavaScript Loaded!');",
        "image.png": "image.png", // image reference, not content
    };

    // Initially display the files in the file explorer
    const fileList = document.getElementById("file-list");

    function updateFileExplorer() {
        fileList.innerHTML = '';
        Object.keys(projectFiles).forEach(fileName => {
            let li = document.createElement("li");
            li.textContent = fileName;
            li.onclick = () => loadFile(fileName);
            fileList.appendChild(li);
        });
    }

    // Load a selected file into the editor
    function loadFile(fileName) {
        const fileContent = projectFiles[fileName];
        let editorContainer = document.getElementById("editor-container");
        editorContainer.innerHTML = '';

        if (fileName.endsWith(".html")) {
            // HTML File Editor
            const textarea = document.createElement("textarea");
            textarea.value = fileContent;
            textarea.id = "html-editor";
            editorContainer.appendChild(textarea);
        } else if (fileName.endsWith(".css")) {
            // CSS File Editor
            const textarea = document.createElement("textarea");
            textarea.value = fileContent;
            textarea.id = "css-editor";
            editorContainer.appendChild(textarea);
        } else if (fileName.endsWith(".js")) {
            // JS File Editor
            const textarea = document.createElement("textarea");
            textarea.value = fileContent;
            textarea.id = "js-editor";
            editorContainer.appendChild(textarea);
        }

        // Update the preview as the user types
        updatePreview();
    }

    // Save the content of the editor to the corresponding file
    function saveFile() {
        const htmlEditor = document.getElementById("html-editor");
        const cssEditor = document.getElementById("css-editor");
        const jsEditor = document.getElementById("js-editor");

        if (htmlEditor) projectFiles["index.html"] = htmlEditor.value;
        if (cssEditor) projectFiles["styles.css"] = cssEditor.value;
        if (jsEditor) projectFiles["script.js"] = jsEditor.value;

        alert("File saved successfully!");
        updatePreview();
    }

    // Update the preview window by compiling HTML, CSS, and JS
    function updatePreview() {
        const iframe = document.getElementById("preview-frame");
        const htmlContent = projectFiles["index.html"];
        const cssContent = projectFiles["styles.css"];
        const jsContent = projectFiles["script.js"];

        let iframeDocument = iframe.contentDocument || iframe.contentWindow.document;
        iframeDocument.open();

        // Inject HTML content
        iframeDocument.write(htmlContent);

        // Inject CSS if available
        if (cssContent) {
            const styleTag = iframeDocument.createElement("style");
            styleTag.innerHTML = cssContent;
            iframeDocument.head.appendChild(styleTag);
        }

        // Inject JS if available
        if (jsContent) {
            const scriptTag = iframeDocument.createElement("script");
            scriptTag.innerHTML = jsContent;
            iframeDocument.body.appendChild(scriptTag);
        }

        iframeDocument.close();
    }

    // Initialize the app and load the file explorer
    updateFileExplorer();
</script>

</body>
</html>
